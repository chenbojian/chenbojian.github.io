<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="just a blog">
<meta property="og:type" content="website">
<meta property="og:title" content="CBJ&#39;s Blog">
<meta property="og:url" content="http://chenbojian.github.io/index.html">
<meta property="og:site_name" content="CBJ&#39;s Blog">
<meta property="og:description" content="just a blog">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="chenbojian">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://chenbojian.github.io/"/>





  <title>CBJ's Blog</title>
  








<meta name="generator" content="Hexo 4.2.1"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">CBJ's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">~~~</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/%20" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/%20" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://chenbojian.github.io/2018/11/07/%E4%B8%BA%E4%BB%80%E4%B9%88%E6%88%91%E7%9A%84chrome%E6%80%BB%E6%98%AF%E8%87%AA%E5%8A%A8%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="chenbojian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CBJ's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/07/%E4%B8%BA%E4%BB%80%E4%B9%88%E6%88%91%E7%9A%84chrome%E6%80%BB%E6%98%AF%E8%87%AA%E5%8A%A8%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6/" itemprop="url">为什么我的chrome总是自动安装插件</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-11-07T14:48:01+08:00">
                2018-11-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近用mac的chrome遇到了一个很烦人的问题，每次新建一个profile的时候，chrome都会提示自动安装了fuze，记录一下解决方案。</p>
<p>我开始的时候用google搜索了很久都没有找到相应的解决方案，甚至研究了chrome的一些配置，但是太过复杂，不得不放弃。</p>
<p>后来终于在Google Chrome Help Forum搜索fuze得到了这样一个<a href="https://productforums.google.com/forum/#!topic/chrome/mr3ECzJcspA" target="_blank" rel="noopener">问题</a></p>
<blockquote>
<p>Hello,</p>
<p>I installed a Chrome extension called ‘Fuze on Chrome’ in October 2016. I’ve tried to delete it through Chrome Extensions Settings, however, every time I create a new Chrome profile on this computer, Fuze on Chrome automatically installs. I can’t find Fuze on Chrome in the Chrome Web Store anymore. How do I delete this extension from my local machine for good?</p>
<p>Other funky behavior:</p>
<ol>
<li><p>In ‘chrome://extensions’, when I click Trash Icon &gt; Check the checkbox for Report Abuse  &gt; Click ‘Remove’ , I receive a 404 error and I am redirected to this URL: <a href="https://chrome.google.com/webstore/report/kcehcblfpidimbihdfophhhdejckolgh?utm_source=chrome-remove-extension-dialog" target="_blank" rel="noopener">https://chrome.google.com/webstore/report/kcehcblfpidimbihdfophhhdejckolgh?utm_source=chrome-remove-extension-dialog</a>. </p>
</li>
<li><p>I cannot find the folder with its corresponding Developer ID under this directory: ~/Library/Application Support/Google/Chrome/Default/Extensions</p>
</li>
<li><p>I tried deleting all key references of the developer id and its corresponding values within the ~/Library/Application Support/Google/Chrome/Default/Preferences file, but it somehow gets populated again after I rewrite it. (Apologies if this is standard behavior, I’m not familiar with the Chrome Extension development process).</p>
</li>
<li><p>I’ve tried deleting the Chrome application from my system and reinstalling it, but Fuze automatically gets reinstalled. It is also showing up when I reinstall Chrome Canary. </p>
</li>
</ol>
<p>Any assistance would be greatly appreciated!</p>
<p>Thanks,<br>S</p>
</blockquote>
<p>答案是</p>
<blockquote>
<p>Hi, I figured out to delete it. Go into:</p>
<p>“/Library/Application Support/Google/Chrome/External Extensions”</p>
<p>and delete the file called: “kcehcblfpidimbihdfophhhdejckolgh.json”</p>
</blockquote>
<p>这个目录是chrome提供的自动安装extension的一种方式，详细可以参考<a href="https://developer.chrome.com/apps/external_extensions" target="_blank" rel="noopener">官方文档</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://chenbojian.github.io/2018/10/29/How-pipenv-find-virtual-env-automatically/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="chenbojian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CBJ's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/10/29/How-pipenv-find-virtual-env-automatically/" itemprop="url">How pipenv find virtual env automatically</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-10-29T14:07:54+08:00">
                2018-10-29
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="什么是pipenv"><a href="#什么是pipenv" class="headerlink" title="什么是pipenv"></a>什么是pipenv</h2><blockquote>
<p>Pipenv is a tool that aims to bring the best of all packaging worlds (bundler, composer, npm, cargo, yarn, etc.) to the Python world. </p>
</blockquote>
<p>Pipenv是pip与virtualenv的结合，可以自动创建python虚拟环境，方便开发和管理依赖。</p>
<p>当我们使用virtualenv来创建虚拟环境的时候，我们需要制定一个目录，通常的做法是放在当前项目的env目录下，然后<code>source env/bin/activate</code>。</p>
<p>但我们并不希望将env提交到git仓库中，那么其他人想要开发就需要重新生成这个目录，每次开发都需要执行一次<code>source</code>。pipenv为我们解决了这样的问题，它可以让你忽略virtualenv的存在，只需要使用pipenv的命令就可以拥有方便的开发环境。</p>
<h2 id="pipenv自动创建virtualenv的convention是什么？"><a href="#pipenv自动创建virtualenv的convention是什么？" class="headerlink" title="pipenv自动创建virtualenv的convention是什么？"></a>pipenv自动创建virtualenv的convention是什么？</h2><p>在mac中可以看到pipenv生成的virtualenv默认位于像这样的目录中</p>
<p><code>$HOME/.local/share/virtualenvs/projectname-hashcode/</code></p>
<p>那么后面的<code>hashcode</code>究竟是如何生成的呢？我阅读了下pipenv源码研究了下。</p>
<p>在<code>pipenv/project.py</code>中有一个方法来获得virtualenv的location</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">@property</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">virtualenv_location</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">    <span class="comment"># if VIRTUAL_ENV is set, use that.</span></span><br><span class="line">    <span class="keyword">if</span> <span class="symbol">PIPENV_VIRTUALENV:</span></span><br><span class="line">        <span class="keyword">return</span> PIPENV_VIRTUALENV</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">self</span>.<span class="symbol">_virtualenv_location:</span>  <span class="comment"># Use cached version, if available.</span></span><br><span class="line">        assert <span class="keyword">self</span>.project_directory, <span class="string">"project not created"</span></span><br><span class="line">        <span class="keyword">self</span>._virtualenv_location = <span class="keyword">self</span>.get_location_for_virtualenv()</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>._virtualenv_location</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_location_for_virtualenv</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">self</span>.is_venv_in_project()<span class="symbol">:</span></span><br><span class="line">        <span class="keyword">return</span> os.path.join(<span class="keyword">self</span>.project_directory, <span class="string">".venv"</span>)</span><br><span class="line"></span><br><span class="line">    name = <span class="keyword">self</span>.virtualenv_name</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">self</span>.<span class="symbol">project_directory:</span></span><br><span class="line">        venv_path = os.path.join(<span class="keyword">self</span>.project_directory, <span class="string">".venv"</span>)</span><br><span class="line">        <span class="keyword">if</span> os.path.exists(venv_path) <span class="keyword">and</span> <span class="keyword">not</span> os.path.isdir(<span class="string">".venv"</span>)<span class="symbol">:</span></span><br><span class="line">            with io.open(venv_path, <span class="string">"r"</span>) as <span class="symbol">f:</span></span><br><span class="line">                name = f.read().strip()</span><br><span class="line">            <span class="comment"># Assume file's contents is a path if it contains slashes.</span></span><br><span class="line">            <span class="keyword">if</span> looks_like_dir(name)<span class="symbol">:</span></span><br><span class="line">                <span class="keyword">return</span> vistir.compat.Path(name).absolute().as_posix()</span><br><span class="line">    <span class="keyword">return</span> str(get_workon_home().joinpath(name))</span><br></pre></td></tr></table></figure>

<p>当选择在项目内生成venv时，目录名是<code>.venv</code>，默认会使用计算的<code>self.virtualenv_name</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@property</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">virtualenv_name</span><span class="params">(self)</span>:</span></span><br><span class="line">    sanitized, encoded_hash = self._get_virtualenv_hash(self.name)</span><br><span class="line">    suffix = <span class="string">"-&#123;0&#125;"</span>.format(PIPENV_PYTHON) <span class="keyword">if</span> PIPENV_PYTHON <span class="keyword">else</span> <span class="string">""</span></span><br><span class="line">    <span class="comment"># If the pipfile was located at '/home/user/MY_PROJECT/Pipfile',</span></span><br><span class="line">    <span class="comment"># the name of its virtualenv will be 'my-project-wyUfYPqE'</span></span><br><span class="line">    <span class="keyword">return</span> sanitized + <span class="string">"-"</span> + encoded_hash + suffix</span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">def</span> <span class="title">_get_virtualenv_hash</span><span class="params">(self, name)</span>:</span></span><br><span class="line">    <span class="string">"""Get the name of the virtualenv adjusted for windows if needed</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Returns (name, encoded_hash)</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_name</span><span class="params">(name, location)</span>:</span></span><br><span class="line">        name = self._sanitize(name)</span><br><span class="line">        hash = hashlib.sha256(location.encode()).digest()[:<span class="number">6</span>]</span><br><span class="line">        encoded_hash = base64.urlsafe_b64encode(hash).decode()</span><br><span class="line">        <span class="keyword">return</span> name, encoded_hash[:<span class="number">8</span>]</span><br><span class="line"></span><br><span class="line">    clean_name, encoded_hash = get_name(name, self.pipfile_location)</span><br><span class="line">    venv_name = <span class="string">"&#123;0&#125;-&#123;1&#125;"</span>.format(clean_name, encoded_hash)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># This should work most of the time for</span></span><br><span class="line">    <span class="comment">#   Case-sensitive filesystems,</span></span><br><span class="line">    <span class="comment">#   In-project venv</span></span><br><span class="line">    <span class="comment">#   "Proper" path casing (on non-case-sensitive filesystems).</span></span><br><span class="line">    <span class="keyword">if</span> (</span><br><span class="line">        fnmatch.fnmatch(<span class="string">"A"</span>, <span class="string">"a"</span>)</span><br><span class="line">        <span class="keyword">or</span> self.is_venv_in_project()</span><br><span class="line">        <span class="keyword">or</span> get_workon_home().joinpath(venv_name).exists()</span><br><span class="line">    ):</span><br><span class="line">        <span class="keyword">return</span> clean_name, encoded_hash</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Check for different capitalization of the same project.</span></span><br><span class="line">    <span class="keyword">for</span> path <span class="keyword">in</span> get_workon_home().iterdir():</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> is_virtual_environment(path):</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            env_name, hash_ = path.name.rsplit(<span class="string">"-"</span>, <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">except</span> ValueError:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> len(hash_) != <span class="number">8</span> <span class="keyword">or</span> env_name.lower() != name.lower():</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">return</span> get_name(env_name, self.pipfile_location.replace(name, env_name))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Use the default if no matching env exists.</span></span><br><span class="line">    <span class="keyword">return</span> clean_name, encoded_hash</span><br></pre></td></tr></table></figure>

<p>这就是pipenv计算hash的方式，可以看到用来生成hash的是<code>self.pipfile_location</code>，让我们来确认下这个的值会是什么？</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@property</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pipfile_location</span><span class="params">(self)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> PIPENV_PIPFILE:</span><br><span class="line">        <span class="keyword">return</span> PIPENV_PIPFILE</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> self._pipfile_location <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            loc = pipfile.Pipfile.find(max_depth=PIPENV_MAX_DEPTH)</span><br><span class="line">        <span class="keyword">except</span> RuntimeError:</span><br><span class="line">            loc = <span class="literal">None</span></span><br><span class="line">        self._pipfile_location = _normalized(loc)</span><br><span class="line">    <span class="keyword">return</span> self._pipfile_location</span><br></pre></td></tr></table></figure>

<p>在<code>pipenv/patched/pipfile/api.py</code>中找到了<code>find</code>方法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pipfile</span><span class="params">(object)</span>:</span></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">find</span><span class="params">(max_depth=<span class="number">3</span>)</span>:</span></span><br><span class="line">        <span class="string">"""Returns the path of a Pipfile in parent directories."""</span></span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> c, d, f <span class="keyword">in</span> walk_up(os.getcwd()):</span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> i &lt; max_depth:</span><br><span class="line">                <span class="keyword">if</span> <span class="string">'Pipfile'</span>:</span><br><span class="line">                    p = os.path.join(c, <span class="string">'Pipfile'</span>)</span><br><span class="line">                    <span class="keyword">if</span> os.path.isfile(p):</span><br><span class="line">                        <span class="keyword">return</span> p</span><br><span class="line">        <span class="keyword">raise</span> RuntimeError(<span class="string">'No Pipfile found!'</span>)</span><br></pre></td></tr></table></figure>

<p>location将会是Pipfile的absolute path，也就是项目的根目录的绝对路径，pipenv使用这个绝对路径来生成一个hash避免同名项目目录的冲突。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://chenbojian.github.io/2016/11/04/T-SQL-magic/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="chenbojian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CBJ's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/11/04/T-SQL-magic/" itemprop="url">T-SQL magic</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-11-04T17:39:23+08:00">
                2016-11-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="How-to-get-indexes-of-current-database"><a href="#How-to-get-indexes-of-current-database" class="headerlink" title="How to get indexes of current database?"></a>How to get indexes of current database?</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> sys.indexes</span><br></pre></td></tr></table></figure>

<h2 id="How-to-get-replication-articles"><a href="#How-to-get-replication-articles" class="headerlink" title="How to get replication articles?"></a>How to get replication articles?</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">  msp.publication <span class="keyword">AS</span> PublicationName,</span><br><span class="line">  msa.publisher_db <span class="keyword">AS</span> DatabaseName,</span><br><span class="line">  msa.article <span class="keyword">AS</span> ArticleName,</span><br><span class="line">  msa.source_owner <span class="keyword">AS</span> SchemaName,</span><br><span class="line">  msa.source_object <span class="keyword">AS</span> TableName</span><br><span class="line"><span class="keyword">FROM</span> distribution.dbo.MSarticles msa</span><br><span class="line"><span class="keyword">JOIN</span> distribution.dbo.MSpublications msp <span class="keyword">ON</span> msa.publication_id = msp.publication_id</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> </span><br><span class="line">  msp.publication, </span><br><span class="line">  msa.article</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> syspublications</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> sysarticles <span class="keyword">where</span> pubid = <span class="number">3</span></span><br></pre></td></tr></table></figure>

<ul>
<li><a href="https://msdn.microsoft.com/en-us/library/ms179855.aspx" target="_blank" rel="noopener">More info mation get get replication related table.</a></li>
<li><a href="https://msdn.microsoft.com/en-us/library/dn198334.aspx" target="_blank" rel="noopener">Replication infomation</a></li>
<li><a href="https://msdn.microsoft.com/en-us/library/ms174364.aspx" target="_blank" rel="noopener">Replication stored procedure</a></li>
</ul>
<h2 id="Useful-replication-stored-procedure"><a href="#Useful-replication-stored-procedure" class="headerlink" title="Useful replication stored procedure."></a>Useful replication stored procedure.</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">exec sp_dropsubscription</span><br><span class="line">    @publication='**-Publication',</span><br><span class="line">    @article= N'all',</span><br><span class="line">    @subscriber = 'WIN-VPE**FSH8IJ'</span><br><span class="line"></span><br><span class="line">exec sp_droppublication</span><br><span class="line">    @publication='**-Publication'</span><br><span class="line"></span><br><span class="line">exec sp_removedbreplication @dbname='**-local'</span><br></pre></td></tr></table></figure>

<h2 id="How-to-close-connect-and-drop-db-in-sql-server"><a href="#How-to-close-connect-and-drop-db-in-sql-server" class="headerlink" title="How to close connect and drop db in sql server?"></a>How to close connect and drop db in sql server?</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">database</span> [dbname] <span class="keyword">set</span> SINGLE_USER <span class="keyword">with</span> <span class="keyword">rollback</span> <span class="keyword">immediate</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">database</span> [dbname]</span><br></pre></td></tr></table></figure>

<h2 id="Other-collections"><a href="#Other-collections" class="headerlink" title="Other collections"></a>Other collections</h2><ul>
<li><a href="http://www.c-sharpcorner.com/article/50-important-queries-in-sql-server/" target="_blank" rel="noopener">SqlServer important queries</a></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://chenbojian.github.io/2016/01/06/javascript-arguments/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="chenbojian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CBJ's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/01/06/javascript-arguments/" itemprop="url">javascript-arguments</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-01-06T20:40:17+08:00">
                2016-01-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="arguments"><a href="#arguments" class="headerlink" title="arguments"></a>arguments</h2><p>先从问题出发</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="built_in">arguments</span>.map(<span class="function"><span class="params">x</span> =&gt;</span> x * <span class="number">3</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<p>结果是什么呢？大家可以复制到console中尝试下。</p>
<p>从代码可以看到我们使用了arguments，这是javascript function的特殊变量，用来表示整个参数列表，是一个Array like的对象，为什么说它是Array like的对象呢？因为arguments并不是一个Array对象，所以上面问题的结果是<code>Uncaught TypeError: arguments.map is not a function</code>，可以看到arguments并不是真正的Array对象，那么如何让上面的代码输出<code>[3, 6, 9]</code>这样的结果呢？</p>
<p>ES6前的javascript代码通常需要这样写</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="built_in">Array</span>.prototype.map.call(<span class="built_in">arguments</span>, <span class="function"><span class="keyword">function</span> (<span class="params">x</span>) </span>&#123; <span class="keyword">return</span> x * <span class="number">3</span>;&#125;);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<p>或者将其转化为数组再应用<code>map</code>这样的数组方法</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>)</span><br><span class="line">                .map(<span class="function"><span class="keyword">function</span> (<span class="params">x</span>) </span>&#123; <span class="keyword">return</span> x * <span class="number">3</span>;&#125;);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<p>那么在ES6中我们可以怎样实现呢？</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function">(<span class="params">...args</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> args.map(<span class="function"><span class="params">x</span> =&gt;</span> x * <span class="number">3</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<p>或着更简洁的转化Array like为Array的方法</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="built_in">Array</span>.from(<span class="built_in">arguments</span>).map(<span class="function"><span class="params">x</span> =&gt;</span> x * <span class="number">3</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<p>无论哪种看起来都比ES5的实现漂亮很多，这里Array.from是ES6中新增的一个用来将类数组对象转化为数组对象的方法，前面我们提到了多次Array like对象，下面的对象就是Array like的</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arrayLike = &#123;</span><br><span class="line">    <span class="string">"0"</span>: <span class="number">9</span>,</span><br><span class="line">    <span class="string">"2"</span>: <span class="number">8</span>,</span><br><span class="line">    <span class="string">"1"</span>: <span class="number">7</span>,</span><br><span class="line">    length: <span class="number">3</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Array</span>.from(arrayLike)) <span class="comment">// [9, 7, 8]</span></span><br></pre></td></tr></table></figure>

<h2 id="rest-arguments"><a href="#rest-arguments" class="headerlink" title="rest arguments"></a>rest arguments</h2><p>我们再看下另外一种ES6实现当中的<code>...args</code>，看起来似乎和Java的变长参数很像，这在ES6的语法中叫做剩余参数，使用剩余参数可以代替<code>arguments</code>，比如前面提到的例子。剩余参数叫做剩余参数，当然也可以和正常参数一起使用，比如</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">a, ...args</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> args.reduce(<span class="function">(<span class="params">x,y</span>) =&gt;</span> x + y, a);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(sum(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>));</span><br></pre></td></tr></table></figure>
<p>需要注意，rest参数只能是最后一个参数，不能再有其他参数，否则会报错。</p>
<h2 id="default-arguments"><a href="#default-arguments" class="headerlink" title="default arguments"></a>default arguments</h2><p>除了rest参数，ES6还提供了默认参数的功能，我们先看一个问题</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">log</span>(<span class="params">x, y</span>) </span>&#123;</span><br><span class="line">    y = y || <span class="string">'World'</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(x, y);</span><br><span class="line">&#125;</span><br><span class="line">log(<span class="string">'Hello'</span>);</span><br><span class="line">log(<span class="string">'Hello'</span>, <span class="string">'China'</span>);</span><br><span class="line">log(<span class="string">'Hello'</span>, <span class="string">''</span>);</span><br></pre></td></tr></table></figure>
<p>三个log分别是什么结果呢？结果都是<code>Hello China</code>，第三个log的结果和我们调用的预期是不一样的，那么如何避免呢？</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 写法一</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> y === <span class="string">'undefined'</span>) &#123;</span><br><span class="line">    y = <span class="string">'World'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 写法二</span></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">arguments</span>.length === <span class="number">1</span>) &#123;</span><br><span class="line">    y = <span class="string">'World'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>那么使用了ES6的默认参数后是就可以直接按照问题的写法去写了</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">log</span>(<span class="params">x, y = <span class="string">'World'</span></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(x, y);</span><br><span class="line">&#125;</span><br><span class="line">log(<span class="string">'Hello'</span>);</span><br><span class="line">log(<span class="string">'Hello'</span>, <span class="string">'World'</span>);</span><br><span class="line">log(<span class="string">'Hello'</span>, <span class="string">''</span>);</span><br></pre></td></tr></table></figure>
<p>默认参数最大的好处就是可以直接从函数参数表知道哪些参数是可选参数，而不用具体阅读其实现。</p>
<h2 id="destructuring"><a href="#destructuring" class="headerlink" title="destructuring"></a>destructuring</h2><p>Quiz</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">3</span>, b = <span class="number">4</span>;</span><br><span class="line">[a, b] = [b, a];</span><br><span class="line"><span class="built_in">console</span>.log(a, b);</span><br></pre></td></tr></table></figure>
<p>用过python或者ruby的同学对这种写法一定已经非常熟悉了，现在ES6也支持这种fancy的特性了，这种语法被叫做解构</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> [a, [[b], c]] = [<span class="number">1</span>, [[<span class="number">2</span>], <span class="number">3</span>]];</span><br><span class="line"><span class="built_in">console</span>.log(a,b,c);</span><br><span class="line"><span class="keyword">var</span> [ , , third] = [<span class="string">"foo"</span>, <span class="string">"bar"</span>, <span class="string">"baz"</span>];</span><br><span class="line"><span class="built_in">console</span>.log(third);</span><br><span class="line"><span class="keyword">var</span> [x, , y] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="built_in">console</span>.log(x,y);</span><br><span class="line"><span class="keyword">var</span> [head, ...tail] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line"><span class="built_in">console</span>.log(head,tail);</span><br><span class="line"><span class="keyword">var</span> [x, y, ...z] = [<span class="string">'a'</span>];</span><br><span class="line"><span class="built_in">console</span>.log(x,y,z);</span><br></pre></td></tr></table></figure>
<p>解构也可以有默认值</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> [y = <span class="number">3</span>] = [];</span><br><span class="line"><span class="built_in">console</span>.log(y);</span><br><span class="line"><span class="keyword">var</span> [x, y = <span class="number">3</span>] = [<span class="string">'a'</span>];</span><br><span class="line"><span class="built_in">console</span>.log(x, y);</span><br><span class="line"><span class="keyword">var</span> [x = <span class="number">3</span>, y = <span class="number">4</span>] = [<span class="literal">undefined</span>, <span class="number">1</span>]</span><br><span class="line"><span class="built_in">console</span>.log(x, y);</span><br></pre></td></tr></table></figure>

<p>可以对数组解构，也可以对对象结构，那么对象的解构是什么样的呢？</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> &#123;<span class="attr">foo</span>: x, <span class="attr">bar</span>: y&#125; = &#123;<span class="attr">foo</span>: <span class="string">'aaa'</span>, <span class="attr">bar</span>: <span class="string">'bbb'</span>&#125;;</span><br><span class="line"><span class="built_in">console</span>.log(x);</span><br><span class="line"><span class="built_in">console</span>.log(y); </span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> &#123; prop, prop2&#125; = &#123;<span class="attr">prop</span>: <span class="number">5</span>, <span class="attr">prop2</span>: <span class="number">10</span>&#125;;</span><br><span class="line"><span class="built_in">console</span>.log(prop, prop2);</span><br></pre></td></tr></table></figure>
<p>那么函数的参数也可以写成这样的形式</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">&#123;x, y = <span class="number">5</span>&#125;</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(x, y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">foo(&#123;&#125;) <span class="comment">// undefined, 5</span></span><br><span class="line">foo(&#123;<span class="attr">x</span>: <span class="number">1</span>&#125;) <span class="comment">// 1, 5</span></span><br><span class="line">foo(&#123;<span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="number">2</span>&#125;) <span class="comment">// 1, 2</span></span><br><span class="line">foo() <span class="comment">// TypeError: Cannot read property 'x' of undefined</span></span><br></pre></td></tr></table></figure>
<p>解构有很多用途，比如可以做这种事情</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> something = [</span><br><span class="line">    &#123;<span class="attr">url</span>: <span class="string">'baidu.com'</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">url</span>: <span class="string">'google.com'</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">url</span>: <span class="string">'facebook.com'</span>&#125;</span><br><span class="line">];</span><br><span class="line"><span class="comment">//pluck</span></span><br><span class="line"><span class="keyword">var</span> urls = something.map(<span class="function">(<span class="params">&#123; url &#125;</span>) =&gt;</span> url);</span><br><span class="line"><span class="built_in">console</span>.log(urls);</span><br></pre></td></tr></table></figure>
<p>但对象的解构需要注意，如果将声明与实现分开，需要将表达式放置于括号中</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a, b;</span><br><span class="line">&#123;a,b&#125; = &#123;<span class="attr">a</span>:<span class="number">3</span>,<span class="attr">b</span>:<span class="number">4</span>&#125;;</span><br><span class="line"><span class="built_in">console</span>.log(a,b);</span><br><span class="line"><span class="comment">//error</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a, b;</span><br><span class="line">(&#123;a,b&#125; = &#123;<span class="attr">a</span>:<span class="number">3</span>,<span class="attr">b</span>:<span class="number">4</span>&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(a,b);</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://chenbojian.github.io/2016/01/03/%E5%9C%A8windows%E4%B8%8B%E4%B9%A0%E6%83%AF%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%93%8D%E4%BD%9C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="chenbojian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CBJ's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/01/03/%E5%9C%A8windows%E4%B8%8B%E4%B9%A0%E6%83%AF%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%93%8D%E4%BD%9C/" itemprop="url">在windows下习惯命令行操作</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-01-03T14:03:57+08:00">
                2016-01-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>命令行的哲学与快捷键的哲学非常相似，为什么快捷键可以提高我们的效率, 因为鼠标操作需要经历手离开键盘移到鼠标上、移动定位按钮、点击、手移回键盘上的过程，而使用快捷键往往只需要按键盘上的几个键就可以完成同样的任务，如果鼠标操作需要1到2秒，那么快捷键操作通常只要0点几秒。为什么需要命令行操作道理也是一样的。</p>
<p>在linux的世界中, 可以通过命令行高效的完成很多事情, 比如常见的<code>ls, grep, cat</code>等等, 因为这些工具的存在, linux程序员几乎可以在命令行下完成所有的工作, 这种工作方式既极客又高效, 习惯了这种工作方式后就再也不想用鼠标了。</p>
<p>但并不是所有时候都能使用mac或者linux进行编程工作的，我们不得不去面对缺乏命令行工具的windows世界，虽然有着宇宙最强ide，但这并不能取代命令行给我们带来的高效。那么在windows下有没有办法高效的利用命令行呢？答案是肯定的。</p>
<h2 id="powershell"><a href="#powershell" class="headerlink" title="powershell"></a>powershell</h2><p>powershell是windows为了取代cmd而产生的命令行工具，powershell提供了比linux shell更好的语法，但这并不能改变windows下命令行程序缺乏这一致命缺陷。如今流行的工具都会提供windows版本，比如nodejs，比如git，这在一定程度上缓解了windows下命令行不好用的问题。我曾经写了一篇介绍conemu的文章，介绍了以bat文件为基础快速启动命令行并配置好常用的环境变量的方式。</p>
<p>这里将介绍另一种快速启动命令行的方式，以及快速启动常用程序的方式</p>
<p>在windows中，lnk文件代表快捷方式，往往我们都是通过在桌面或者开始菜单建立快捷方式来快速打开某个程序，大部分程序在安装过程也会帮我们完成这些事情，但这仍然需要大量的鼠标操作。lnk文件正是我们要做到快速启动程序的关键，lnk文件可以在windows的<code>Run</code>中省略后缀打开，比如打开处于环境变量中<code>z.lnk</code>文件只需要四个键即可完成，<code>Win + R</code> <code>z</code> <code>Enter</code>。</p>
<p>所以在windows下我的设置是这样的</p>
<ul>
<li>将某个常用的目录加入环境变量path中比如<code>C:\chenbojian</code></li>
<li>将指向conemu的快捷方式<code>z.lnk</code>放入该目录中</li>
<li>快捷键快速启动并享受命令行。</li>
</ul>
<p>这样启动powershell后会从<code>$PROFILE</code>中加载环境，如果你懂一些powershell的语法就可以像写.bashrc一样轻松的调教你的powershell，让他支持你喜欢的命令，比如我增加了vim的alias<code>Set-Alias vi path/to/gvim.exe</code>，你也可以添加你喜欢的编辑器比如vscode，sublime等。这样我们就得到了类似linux命令行的体验了。</p>
<h2 id="something-else"><a href="#something-else" class="headerlink" title="something else"></a>something else</h2><p>使用powershell以及快捷键虽然得到了很好的体验，但仍然有着极大的差距，这主要因为windows的编译工具链与linux系的差别，linux程序往往都是通过源码发布的，然后在用户机器上编译得到可执行文件，这主要依赖于Linux中广泛存在多年的automake工具链，但windows并没有automake工具链，这使得windows下从源码编译变得异常困难，这使得很多好用的linux工具无法及时在windows下得到更新。</p>
<p>windows下也存在着cygwin和msys2这样的让linux程序直接在windows下编译的工具，我也曾经使用过，但windows下总有些别扭，尤其是字符集的不一致导致乱码问题。windows虽然内核早已使用unicode，但是对于中文支持确是一直使用了gbk的方式，比如chcp65001后就无法输入中文的命令行，种种因素使得windows下使用linux工具不够完美的体验。</p>
<p>随着windows10的发布windows似乎正在做着一系列的事情来吸引开源开发者对windows平台的关注，希望windows能在开源的世界中重新焕发活力。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://chenbojian.github.io/2015/07/06/hibernate%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="chenbojian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CBJ's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/07/06/hibernate%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/" itemprop="url">hibernate学习记录</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-07-06T15:15:20+08:00">
                2015-07-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="merge-与-update"><a href="#merge-与-update" class="headerlink" title="merge 与 update"></a>merge 与 update</h2><p>对于transient对象,指明id后,可以使用merge来更新对应数据库条目,也可以使用update来更新,但是如果当前session中存在该id的记录,使用update会抛出异常.</p>
<p>对于detached对象,两者相似,update会将对象持久化,merge不会改变对象状态?(待验证)</p>
<p>对于persist对象,两者相同?(待验证)</p>
<h2 id="merge-与-persist"><a href="#merge-与-persist" class="headerlink" title="merge 与 persist"></a>merge 与 persist</h2><p>persist会将对象持久化,merge不会,其他方面类似,比如如下代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">User user = <span class="keyword">new</span> User();</span><br><span class="line">user.setName(<span class="string">"good user"</span>);</span><br><span class="line">sessionFactory.getCurrentSession().merge(user);</span><br><span class="line"><span class="comment">//user.getId() == 0;</span></span><br></pre></td></tr></table></figure>

<p>merge后会执行insert语句,但并不会改变user的状态,user.id==0</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">User user = <span class="keyword">new</span> User();</span><br><span class="line">user.setName(<span class="string">"good user"</span>);</span><br><span class="line">sessionFactory.getCurrentSession().persist(user);</span><br><span class="line"><span class="comment">//user.getId() != 0;</span></span><br></pre></td></tr></table></figure>

<p>persist后也会执行insert语句,但会改变user的状态为persistent,user.id!=0,修改user的属性在transaction结束后会更新到数据库中.</p>
<p><a href="http://stackoverflow.com/questions/1069992/jpa-entitymanager-why-use-persist-over-merge" target="_blank" rel="noopener">参考stackoverflow回答</a></p>
<h2 id="orphanRemoval-true-与-cascade-CascadeType-DELETE"><a href="#orphanRemoval-true-与-cascade-CascadeType-DELETE" class="headerlink" title="orphanRemoval=true 与 cascade=CascadeType.DELETE"></a>orphanRemoval=true 与 cascade=CascadeType.DELETE</h2><p>孤值删除包括了级联删除的情况. 同时孤值删除还会处理额外的情况, 当断开关系后update时会自动删除有外键的一方.</p>
<h2 id="hibernate继承"><a href="#hibernate继承" class="headerlink" title="hibernate继承"></a>hibernate继承</h2><p>注解方式example</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Inheritance</span>(strategy = InheritanceType.SINGLE_TABLE)</span><br><span class="line"><span class="meta">@DiscriminatorColumn</span>(name = <span class="string">"field"</span>, discriminatorType = DiscriminatorType.STRING)</span><br><span class="line"><span class="meta">@DiscriminatorValue</span>(<span class="string">"dummy"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EntitySuperClass</span> </span>&#123;</span><br><span class="line"><span class="comment">// here definitions go </span></span><br><span class="line"><span class="comment">// but don't define discriminator column here</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@DiscriminatorValue</span>(value=<span class="string">"sub1"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Sub1Class</span> <span class="keyword">extends</span> <span class="title">EntitySuperClass</span> </span>&#123;</span><br><span class="line"><span class="comment">// here definitions go</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h2 id="hibernate在jsp中lazyloading失效的解决方法"><a href="#hibernate在jsp中lazyloading失效的解决方法" class="headerlink" title="hibernate在jsp中lazyloading失效的解决方法"></a>hibernate在jsp中lazyloading失效的解决方法</h2><p>配置enable_lazy_load_no_trans为true</p>
<p>未完待续…</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://chenbojian.github.io/2015/07/03/%E4%B8%AA%E4%BA%BAwindows%E5%B7%A5%E5%85%B7%E6%80%BB%E7%BB%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="chenbojian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CBJ's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/07/03/%E4%B8%AA%E4%BA%BAwindows%E5%B7%A5%E5%85%B7%E6%80%BB%E7%BB%93/" itemprop="url">个人windows工具总结</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-07-03T21:17:02+08:00">
                2015-07-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="ConEmu"><a href="#ConEmu" class="headerlink" title="ConEmu"></a>ConEmu</h2><p>终于不用忍受原始cmd或者powershell难看的界面和难看的字体了。</p>
<p>目前存在一个小问题，我之前一般会把常用的环境变量配置在一个bat文件中，比如cbjps.bat，每次要启动命令行只需要WIN+R，然后输入cbjps即可解决。之前的bat代码如下：</p>
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"><span class="built_in">set</span> <span class="built_in">path</span>=<span class="variable">%path%</span>;C:\python27</span><br><span class="line"><span class="built_in">set</span> <span class="built_in">path</span>=<span class="variable">%path%</span>;C:\python27\scripts</span><br><span class="line"><span class="keyword">call</span> "C:\Program Files (x86)\Microsoft Visual Studio <span class="number">12</span>.<span class="number">0</span>\VC\vcvarsall.bat" x64</span><br><span class="line">powershell</span><br></pre></td></tr></table></figure>

<p>用了ConEmu之后将powershell改成start PATH\TO\ConEmu\ConEmu.exe后可以使用，但是会一闪而过一个cmd窗口，并且ConEmu的窗口不会自动前置，强迫症表示无法忍受，于是想到了用没有窗口的pythonw来启动，解决了窗口不会自动前置的问题。</p>
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"><span class="built_in">set</span> <span class="built_in">path</span>=<span class="variable">%path%</span>;C:\python27</span><br><span class="line"><span class="built_in">set</span> <span class="built_in">path</span>=<span class="variable">%path%</span>;C:\python27\scripts</span><br><span class="line"><span class="keyword">call</span> "C:\Program Files (x86)\Microsoft Visual Studio <span class="number">12</span>.<span class="number">0</span>\VC\vcvarsall.bat" x64</span><br><span class="line">pythonw D:\chenbojian\cbjtool\ConEmu\conemu.pyw</span><br></pre></td></tr></table></figure>

<p>python代码就非常简单了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> subprocess <span class="keyword">as</span> sp</span><br><span class="line">sp.Popen(<span class="string">r"D:\chenbojian\cbjtool\ConEmu\ConEmu64.exe"</span>)</span><br></pre></td></tr></table></figure>

<p>不过有个一闪而过的窗口还没能解决，困难点主要在于cmd可以通过call***.bat来设置环境变量，而powershell简单的这么做，不然就可以把所有的环境配置到powershell的$PROFELE的文件中了，列一下我的$PROFILE内容</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$env:PATH</span>=<span class="variable">$env:PATH</span>+<span class="string">";C:\Program Files\iojs\"</span>+<span class="string">";"</span>+<span class="variable">$env:APPDATA</span>+<span class="string">"\npm"</span></span><br><span class="line"><span class="variable">$env:JAVA_HOME</span>=<span class="string">'C:\Program Files\Java\jdk1.8.0_20'</span></span><br><span class="line"><span class="built_in">set-alias</span> <span class="string">'vi'</span> <span class="string">'gvim'</span></span><br><span class="line"><span class="built_in">set-alias</span> <span class="string">'gradle'</span> <span class="string">'D:\chenbojian\cbjtool\gradle-2.4\bin\gradle.bat'</span></span><br><span class="line"><span class="built_in">set-alias</span> <span class="string">'mvn'</span> <span class="string">'D:\chenbojian\cbjtool\apache-maven-3.3.3\bin\mvn.cmd'</span></span><br><span class="line"><span class="built_in">import-module</span> PsGet</span><br><span class="line"></span><br><span class="line"><span class="comment"># Load posh-git example profile</span></span><br><span class="line">. <span class="string">'C:\Users\johr\Documents\WindowsPowerShell\Modules\posh-git\profile.example.ps1'</span></span><br></pre></td></tr></table></figure>

<p>据说Powershell Community Extension可以解决问题，有个Invoke-batch命令可以从bat文件读取环境变量，有空研究下。</p>
<h3 id="update"><a href="#update" class="headerlink" title="update"></a>update</h3><p>安装了Powershell Community Extension后可以Invoke-batch，也可以直接Import-visualstudiovars来加载vs编译器的环境变量，这样就不需要先从一个bat文件启动conEmu了。windows的运行（WIN+R）可以直接启动快捷方式文件，比如环境变量目录中有cbjps.lnk，只需要WIN+R，然后cbjps即可启动快捷方式对应的程序。不过注册表右键菜单对应项需要直接指向原始exe文件才行。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$env:PATH</span> += <span class="string">";C:\Program Files\iojs\"</span> </span><br><span class="line"><span class="variable">$env:PATH</span> += <span class="string">";"</span> + <span class="variable">$env:APPDATA</span> + <span class="string">"\npm"</span></span><br><span class="line"><span class="variable">$env:PATH</span> += <span class="string">";C:\Python27\"</span> </span><br><span class="line"><span class="variable">$env:PATH</span> += <span class="string">";C:\Python27\scripts\"</span></span><br><span class="line"><span class="comment"># Invoke-BatchFile "C:\Program Files (x86)\Microsoft Visual Studio 12.0\VC\vcvarsall.bat" x64</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">vs</span></span> &#123;</span><br><span class="line">    <span class="built_in">Import-VisualStudioVars</span> <span class="number">2013</span> x64</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$env:JAVA_HOME</span>=<span class="string">'C:\Program Files\Java\jdk1.8.0_20'</span></span><br><span class="line"><span class="built_in">set-alias</span> <span class="string">'vi'</span> <span class="string">'gvim'</span></span><br><span class="line"><span class="built_in">set-alias</span> <span class="string">'gradle'</span> <span class="string">'D:\chenbojian\cbjtool\gradle-2.4\bin\gradle.bat'</span></span><br><span class="line"><span class="built_in">set-alias</span> <span class="string">'mvn'</span> <span class="string">'D:\chenbojian\cbjtool\apache-maven-3.3.3\bin\mvn.cmd'</span></span><br><span class="line"><span class="built_in">import-module</span> PsGet</span><br><span class="line"></span><br><span class="line"><span class="comment"># Load posh-git example profile</span></span><br><span class="line">. <span class="string">'C:\Users\johr\Documents\WindowsPowerShell\Modules\posh-git\profile.example.ps1'</span></span><br></pre></td></tr></table></figure>


<p>未完待续。。。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://chenbojian.github.io/2015/07/03/hibernate-orphanRemoval-and-cascade/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="chenbojian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CBJ's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/07/03/hibernate-orphanRemoval-and-cascade/" itemprop="url">hibernate orphanRemoval and cascade</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-07-03T17:02:48+08:00">
                2015-07-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://stackoverflow.com/questions/18813341/what-is-the-difference-between-cascade-and-orphan-removal-from-db" target="_blank" rel="noopener">查看原文</a></p>
<p>##Cascading Remove</p>
<p>Marking a reference field with CascadeType.REMOVE (or CascadeType.ALL, which includes REMOVE) indicates that remove operations should be cascaded automatically to entity objects that are referenced by that field (multiple entity objects can be referenced by a collection field):</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Employee</span> </span>&#123;</span><br><span class="line">    <span class="meta">@OneToOne</span>(cascade=CascadeType.REMOVE)</span><br><span class="line">    <span class="keyword">private</span> Address address;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>##Orphan Removal</p>
<p>JPA 2 supports an additional and more aggressive remove cascading mode which can be specified using the orphanRemoval element of the @OneToOne and @OneToMany annotations:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Employee</span> </span>&#123;</span><br><span class="line">    <span class="meta">@OneToOne</span>(orphanRemoval=<span class="keyword">true</span>)</span><br><span class="line">    <span class="keyword">private</span> Address address;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>##DIFFERENCE:</p>
<p>The difference between the two settings is in the response to disconnecting a relationship. For example, such as when setting the address field to null or to another Address object.</p>
<p>If orphanRemoval=true is specified the disconnected Address instance is automatically removed. This is useful for cleaning up dependent objects (e.g. Address) that should not exist without a reference from an owner object (e.g. Employee).<br>If only cascade=CascadeType.REMOVE is specified no automatic action is taken since disconnecting a relationship is not a remove operation.</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">chenbojian</p>
              <p class="site-description motion-element" itemprop="description">just a blog</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%20%7C%7C%20archive">
              
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">chenbojian</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
